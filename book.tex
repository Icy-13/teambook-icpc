\documentclass[10pt,landscape,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage[margin=0.2in]{geometry}

\usepackage{listings}
\usepackage{multicol}
\usepackage{courier}
\usepackage{fancyhdr}
\usepackage{titlesec}

\usepackage{xcolor} % для цветов

\lstset{
  language=C++,
  columns=fullflexible,
  basicstyle=\footnotesize\ttfamily,
  showspaces=false,
  aboveskip=0pt,
  belowskip=0pt,
  lineskip=-1pt,
  breaklines=true,
  frame=single,                % рамка вокруг кода
  rulecolor=\color{black},     % цвет рамки
  numbers=left,                % нумерация строк слева
  numberstyle=\tiny\color{black}, % стиль номеров
  numbersep=5pt,               % расстояние от кода до номеров
  backgroundcolor=\color{gray!10}, % светло-серый фон
}

% Колонки
\setlength{\columnsep}{0.5in}
\setlength{\columnseprule}{0.2pt}

% Заголовки компактнее
\titlespacing*{\section}{0pt}{0.5ex}{0.5ex}
\titlespacing*{\subsection}{0pt}{0.25ex}{0.25ex}

% Хедеры
\pagestyle{fancy}
\lhead{Мяу-принцессы: ИТМО}
\chead{}
\rhead{\thepage}

% Макрос для вставки кода
\newcommand{\includecpp}[3]{%
  \subsection{#1}%
  \lstinputlisting{#2/#3}%
}

\begin{document}

\begin{multicols}{3}

\section{Шаблон}
\includecpp{Шаблон}{./algos}{template.cpp}

\section{Структуры данных}

\includecpp{СНМчик}{./algos}{dsu.cpp}
\includecpp{ДД}{./algos}{treap.cpp}
\includecpp{Неявное ДД}{./algos}{implicit_treap.cpp}

\section{Строки}

\includecpp{Строки}{./algos}{strings.cpp}

\section{Деревья}

\includecpp{lca}{./algos}{lca.cpp}
\includecpp{hld}{./algos}{hld.cpp}

\section{Матеша}

\includecpp{Алгебра}{./algos}{algebra.cpp}
\includecpp{Длинка и интмод}{./algos}{long_ar.cpp}
\includecpp{Геома (old)}{./algos}{geometry.cpp}

\end{multicols}

\end{document}
