\documentclass[10pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage[top=0.3in,bottom=0.3in,left=0.3in,right=0.3in,headsep=0.1in]{geometry}

\usepackage{listings}
\usepackage{multicol}
\usepackage{courier}
\usepackage{fancyhdr}
\usepackage{titlesec}
\usepackage{lastpage}
\usepackage{enumitem}

\usepackage{xcolor} % для цветов
\usepackage{amsmath, amssymb, amsthm} % для математических формул

% Компактные списки
\setlist[enumerate]{itemsep=1pt,parsep=0pt,topsep=2pt,partopsep=0pt}

% Уменьшаем отступы вокруг математических формул
\AtBeginDocument{%
  \setlength{\abovedisplayskip}{2pt}%
  \setlength{\belowdisplayskip}{2pt}%
  \setlength{\abovedisplayshortskip}{0pt}%
  \setlength{\belowdisplayshortskip}{1pt}%
}

% Переопределяем align* для уменьшения отступов
\makeatletter
\g@addto@macro\align{\abovedisplayskip=2pt\belowdisplayskip=2pt}
\makeatother

\lstset{
  language=C++,
  columns=fullflexible,
  basicstyle=\footnotesize\ttfamily,
  showspaces=false,
  aboveskip=0pt,
  belowskip=0pt,
  lineskip=-1pt,
  breaklines=true,
  frame=single,                % рамка вокруг кода
  rulecolor=\color{black},     % цвет рамки
  numbers=left,                % нумерация строк слева
  numberstyle=\tiny\color{black}, % стиль номеров
  numbersep=5pt,               % расстояние от кода до номеров
  backgroundcolor=\color{gray!10}, % светло-серый фон
}

% Колонки
\setlength{\columnsep}{0.5in}
\setlength{\columnseprule}{0.2pt}

% Заголовки компактнее
\titlespacing*{\section}{0pt}{0.5ex}{0.5ex}
\titlespacing*{\subsection}{0pt}{0.25ex}{0.25ex}

% Хедеры
\pagestyle{fancy}
\fancyhf{} % Clear all headers and footers
\fancyhead[L]{ITMO University: Kalugin, Markina, Zorin}
\fancyhead[R]{Page \thepage\ of \pageref{LastPage}}
\renewcommand{\headrulewidth}{0.4pt} % Line under header
\setlength{\headheight}{14pt} % Adjust header height

% Макрос для вставки кода
\newcommand{\includecpp}[2]{%
  \subsection{#1}%
  \lstinputlisting{#2}%
}
\begin{document}

\begin{multicols}{3}

\section{Шаблон}
\includecpp{Шаблон}{./algos/template.cpp}

\section{Структуры данных}

\includecpp{ДД}{./algos/treap.cpp}
\includecpp{Неявное ДД}{./algos/implicit_treap.cpp}

\section{Строки}

\includecpp{Строки}{./algos/strings.cpp}

\section{Деревья}

\includecpp{lca}{./algos/lca.cpp}
\includecpp{hld}{./algos/hld.cpp}

\section{Графы}

\includecpp{Мосты и точки сочленения}{./algos/bridges.cpp}

\includecpp{Диниц}{./algos/dinic.cpp}
\includecpp{min-cost-max-flow}{./algos/min-max-flow.cpp}

\section{ДП}

\includecpp{Разделяйка}{./algos/divide-conquer.cpp}
\includecpp{Кнут}{./algos/knuth.cpp}
\includecpp{КХТ}{./algos/cht.cpp}

\section{Матеша}

\includecpp{Алгебра}{./algos/algebra.cpp}
\includecpp{Длинка и интмод}{./algos/long_ar.cpp}
\includecpp{Геома (old)}{./algos/geometry.cpp}
\end{multicols}

\section{Аргументы и факты}
\begin{multicols}{2}
\input{math.tex}
\end{multicols}


\end{document}
